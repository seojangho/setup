#!/bin/bash

set -euo pipefail

topic=$(cat)

while :; do
  start_time=$(date --iso-8601=seconds)
  jdunstify pomodoro "Stay focused on ${topic}!"
  sleep 25m
  end_time=$(date --iso-8601=seconds)
  echo "${topic}" | ssh jangho@mango.jangho.io -p50022 -- /opt/mango/sendmail/pomodoro_success_log "${start_time}" "${end_time}"
  jdunstify pomodoro "Well done! Take a rest :)"
  sleep 5m
done
