#!/bin/bash

set -euo pipefail

cd "${HOME}"
selected=${HOME}/$(find -L . -not -path '*/\.*' -print0 | fzf --read0 --reverse)
if [[ -d "${selected}" ]]; then
  cd "${selected}"
  exec mc
else
  quoted=''
  for arg in "${selected[@]}"; do
    quoted="${quoted} $(printf "%q" "${arg}")"
  done
  exec swaymsg exec -- xdg-open "${quoted}"
fi
